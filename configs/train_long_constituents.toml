[build_graphs]
prices = "data/raw_merged/prices.csv"
constituents = "data/raw_merged/constituents.csv"
fundamentals = "data/raw_merged/fundamentals.csv"
window = 20
feature_mode = "window_plus_summary_fund"

[train]
graphs = "data/processed_long/graphs_constituents.pt"
epochs = 200
batch_size = 32
lr = 0.001
hidden_dim = 128
num_layers = 3
dropout = 0.1
goodness_target = 2.0
goodness_temp = 0.25
ff_layerwise = false
ff_multiscale = true
neg_mode = "mix"
noise_std = 0.05
device = "mps"
loader_workers = 3
torch_num_threads = 8
torch_num_interop_threads = 2
dataloader_persistent_workers = true
dataloader_prefetch_factor = 2
dataloader_pin_memory = false
dataloader_mp_context = "spawn"
seed = 7
log_csv = "reports/ff_train_long_constituents.csv"
plot_path = "reports/ff_train_long_constituents.png"
save_model = "runs/ff_model_long_constituents.pt"
auto_tune_batch = true
auto_tune_max_batch = 32
auto_tune_factor = 2
auto_tune_min_batch = 1
neg_warmup_epochs = 10
neg_mix_start = 0.0
neg_mix_end = 0.8
neg_mix_ramp_epochs = 40
neg_gate_margin = 1.0
grad_clip = 1.0
energy_penalty_weight = 0.0001
energy_penalty_mode = "last"
risk_head_enabled = true
risk_ticker = "MDY"
risk_horizon = 21
risk_loss_weight = 0.1
risk_loss_type = "huber"
risk_standardize = true

# Hallucinated negatives (used when neg_mode = "hallucinate")
hallucinate_steps = 4
hallucinate_lr = 0.03
hallucinate_l2 = 0.04
hallucinate_mean = 0.006
hallucinate_std = 0.006
hallucinate_corr = 0.25
hallucinate_clamp_std = 3.0
hallucinate_node_fraction = 0.4
hallucinate_node_min = 15

[train.hallucinate_curriculum]
enabled = true
start_epoch = 5
ramp_epochs = 30
steps_start = 1
steps_end = 4
lr_start = 0.02
lr_end = 0.03
l2_start = 0.08
l2_end = 0.04
corr_start = 0.3
corr_end = 0.25
node_fraction_start = 0.2
node_fraction_end = 0.4
node_min_start = 10
node_min_end = 15
